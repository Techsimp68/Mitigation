function Start-RoboCopy {
    $sourcePath = "C:\Source"
    $destinationPath = "C:\Destination"

    $psi = New-Object System.Diagnostics.ProcessStartInfo
    $psi.FileName = "robocopy.exe"
    $psi.Arguments = "$sourcePath $destinationPath /MIR"
    $psi.RedirectStandardOutput = $true
    $psi.RedirectStandardError = $true
    $psi.UseShellExecute = $false
    $psi.CreateNoWindow = $true

    $process = New-Object System.Diagnostics.Process
    $process.StartInfo = $psi

    $process.Start() | Out-Null

    # Update progress while RoboCopy is running
    while (!$process.HasExited) {
        $progress = $process.StandardOutput.ReadLine()

        if ($progress -match '(\d+)%') {
            $percentComplete = [int]$Matches[1]
            $progressBar.Value = $percentComplete
            $label.Text = "Progress: $percentComplete%"
            $form.Refresh()
        }

        Start-Sleep -Milliseconds 100
    }
}
